import json

# Load the JSON data
with open('cleaner.json', 'r') as json_file:
    data = json.load(json_file)

# Create the HTML file
html_file = 'cleaner.html'
with open(html_file, 'w', encoding='utf-8') as f:
    f.write('<!DOCTYPE html>\n<html>\n<head>\n<title>Solutions to vulnerabilities</title>\n')
    f.write('<style>\ntable, th, td {\nborder: 1px solid black;\nborder-collapse: collapse;\npadding: 5px;\n}\n</style>\n')
    f.write('</head>\n<body>\n')

    f.write('<table>\n')

    # Write the table header
    f.write('<tr>\n')
    if data:
        first_item = data[0]
        keys = first_item.keys()
        for key in keys:
            f.write(f'<th>{key}</th>\n')
    f.write('</tr>\n')

    # Write the table rows
    for item in data:
        if 'riskdesc' in item:
            riskdesc = item['risk description'].lower().split()[0]
            if riskdesc == 'high':
                bg_color = 'red'
            elif riskdesc == 'medium':
                bg_color = 'yellow'
            elif riskdesc == 'low':
                bg_color = 'green'
            else:
                bg_color = 'white'
        else:
            bg_color = 'white'

        #f.write(f'<tr style="background-color: {bg_color};">\n')
        for key in keys:
            value = item.get(key, '')
            f.write(f'<td style="background-color: {bg_color};">{value}</td>\n')

        f.write('</tr>\n')

    f.write('</table>\n')

    f.write('</body>\n</html>')

print(f"JSON data has been converted to {html_file}")
